webpackJsonp([18],{"31LQ":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("v-snackbar",{attrs:{top:"",timeout:e.snackbarTimeout,color:e.snackbarColor},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n    "+e._s(e.snackbarText)+"\n    "),i("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(t){e.snackbar=!1}}},[e._v("Close")])],1),i("v-content",[i("v-container",{attrs:{fluid:"",tag:"section",id:"grid"}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{"d-flex":"",xs12:"","order-xs5":""}},[i("v-layout",{attrs:{column:""}},[i("v-flex",{staticClass:"display mb-2",attrs:{tag:"h1"}},[e._v("\n              API - Data\n              "),i("v-btn",{staticStyle:{float:"right"},attrs:{color:"success"},on:{click:function(t){e.dialog=!0}}},[e._v("New Endpoint")])],1),i("v-flex",[i("v-alert",{attrs:{type:"error",value:e.error}},[e._v("\n                "+e._s(e.error)+"\n              ")]),i("p",[e._v("The data API allows you to create custom data endpoints on the server.")]),i("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.tableHeaders,items:e.items,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[i("td",[i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(i){i.stopPropagation(),e.editItem(t.item)}}},[e._v(e._s(t.item.module))])]),i("td",[e._v(e._s(t.item.version))]),i("td",[i("v-btn",{staticClass:"mx-0",staticStyle:{float:"right"},attrs:{icon:""},on:{click:function(i){e.deleteItem(t.item)}}},[i("v-icon",{attrs:{color:"pink"}},[e._v("delete")])],1)],1)]}}])},[i("template",{slot:"no-data"},[e._v("\n                  You have not added any API endpoints.\n                ")])],2)],1)],1)],1)],1)],1),i("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition",scrollable:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[i("v-card",{attrs:{tile:""}},[i("v-toolbar",{attrs:{card:"",dark:"",color:"light-blue darken-3"}},[i("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.dialog=!1}}},[i("v-icon",[e._v("close")])],1),i("v-toolbar-title",[e._v(e._s(-1===e.editingIndex?"New":"Edit")+" Endpoint")]),i("v-spacer"),i("v-toolbar-items",[i("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(t){e.save()}}},[e._v("Save")])],1)],1),i("v-card-text",{staticStyle:{padding:"0px"}},[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("v-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{value:!0,outline:"",color:"info",icon:"info"}},[i("strong",[e._v("Endpoint:")]),e._v(" "+e._s(e.loggedUser.sub)+"/"+e._s(e.editingItem.version)+"/"+e._s(e.editingItem.module)+" [GET|POST|PUT|DELETE]\n              ")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs6:""}},[i("v-text-field",{attrs:{rules:e.moduleRules,label:"Name:",placeholder:"",required:"",hint:"Enter the name of the endpoint."},model:{value:e.editingItem.module,callback:function(t){e.$set(e.editingItem,"module",t)},expression:"editingItem.module"}})],1),i("v-flex",{attrs:{xs6:""}},[i("v-text-field",{attrs:{rules:e.versionRules,label:"Version:",placeholder:"e.g: 1.0",required:"",hint:"Enter the version of the endpoint."},model:{value:e.editingItem.version,callback:function(t){e.$set(e.editingItem,"version",t)},expression:"editingItem.version"}})],1)],1),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs6:""}},[i("v-select",{attrs:{items:["None","JWT"],label:"Authentication:"},model:{value:e.editingItem.auth,callback:function(t){e.$set(e.editingItem,"auth",t)},expression:"editingItem.auth"}}),"JWT"===e.editingItem.auth?i("p",{staticStyle:{"margin-top":"-20px",color:"rgba(0,0,0,0.54)","font-size":"12px"}},[e._v("To obtain bearer token, authenticate using POST to "+e._s(e.loggedUser.sub)+"/auth/jwt")]):e._e()],1),i("v-flex",{attrs:{xs6:""}},[i("v-select",{attrs:{items:["None","JSON","HTML","TEXT","JS","XML"],label:"Response Content Type:",hint:"Select response content-type."},model:{value:e.editingItem.header,callback:function(t){e.$set(e.editingItem,"header",t)},expression:"editingItem.header"}})],1)],1),i("h3",[e._v("Source (PHP)")]),i("no-ssr",{attrs:{placeholder:"Loading..."}},[i("codemirror",{attrs:{options:e.cmOption},model:{value:e.editingItem.source,callback:function(t){e.$set(e.editingItem,"source",t)},expression:"editingItem.source"}})],1)],1)],1)],1)],1),i("div",{staticStyle:{flex:"1 1 auto"}})],1)],1)],1)],1)};n._withStripped=!0;var a={render:n,staticRenderFns:[]};t.a=a},F1c2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("teyF"),a=i("31LQ"),r=!1;var s=function(e){r||i("ZphW")},o=i("VU/8")(n.a,a.a,!1,s,null,null);o.options.__file="pages/api/data.vue",t.default=o.exports},"To+1":function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,".CodeMirror{border:1px solid #eee;height:auto;font-family:Ubuntu Mono,Menlo,Consolas,monospace;font-size:13px;line-height:1.1em}.CodeMirror,.CodeMirror-scroll{min-height:calc(100vh - 350px)}.CodeMirror-gutters{left:0!important}",""])},ZphW:function(e,t,i){var n=i("To+1");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("2a2661e8",n,!1,{sourceMap:!1})},teyF:function(e,t,i){"use strict";var n=i("woOf"),a=i.n(n),r=i("Xxa5"),s=i.n(r),o=i("exGp"),l=i.n(o),d=i("Dd8w"),c=i.n(d),u=i("NYxO"),v=(i("4swq"),i("mtWM")),m=i.n(v);t.a={middleware:["authenticated"],components:{},computed:c()({},Object(u.mapGetters)({isAuthenticated:"auth/isAuthenticated",loggedUser:"auth/loggedUser",loggedToken:"auth/loggedToken"})),data:function(){return{error:"",cmOption:{smartIndent:!1,indentWithTabs:!0,tabSize:4,indentUnit:4,foldGutter:!0,styleActiveLine:!0,lineNumbers:!0,line:!0,keyMap:"sublime",mode:"text/x-php"},snackbar:!1,snackbarColor:"green",snackbarText:"",snackbarTimeout:5e3,items:[],tableHeaders:[{text:"Name",value:"module"},{text:"Version",value:"version"},{text:"Actions",value:"module",sortable:!1,align:"right"}],itemActions:[{title:"Start"},{title:"Stop"},{title:"Delete"}],dialog:!1,editingIndex:-1,editingItem:{id:-1,module:"",version:"1.0",source:"",headers:"",config:null,auth:null},defaultItem:{id:-1,module:"",version:"1.0",source:"",headers:"",config:null,auth:null},valid:!0,moduleRules:[function(e){return!!e||"Module name is required"},function(e){return e&&e.length<=100||"Module name must be less than 100 characters"}],versionRules:[function(e){return!!e||"Version is required"},function(e){return e&&Number(e)||"Version must be a number"}]}},mounted:function(){this.initialize()},watch:{dialog:function(e){e||this.close()}},methods:{initialize:function(){var e=l()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.loggedUser||this.$router.replace("/servers"),m.a.defaults.headers.common.Authorization="Bearer "+this.loggedToken,e.next=5,m.a.get(this.loggedUser.sub+"/api/ams/data");case 5:t=e.sent,this.items=t.data.data,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.error="Could not fetch data from server.";case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}(),editItem:function(e){this.editingIndex=this.items.indexOf(e),this.editingItem=a()({},e),this.dialog=!0},deleteItem:function(){var e=l()(s.a.mark(function e(t){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.items.indexOf(t),this.items.splice(i,1),e.prev=2,this.loggedUser||this.$router.replace("/servers"),m.a.defaults.headers.common.Authorization="Bearer "+this.loggedToken,e.next=7,m.a.delete(this.loggedUser.sub+"/api/ams/data",{data:t});case 7:e.sent,this.snackbar=!0,this.snackbarText="Endpoint successfully deleted.",e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),this.error="Could not delete endpoint from server.";case 15:case"end":return e.stop()}},e,this,[[2,12]])}));return function(t){return e.apply(this,arguments)}}(),save:function(){var e=l()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.$refs.form.validate()){e.next=16;break}return this.editingIndex>-1?a()(this.items[this.editingIndex],this.editingItem):this.items.push(a()({},this.editingItem)),e.prev=2,this.loggedUser||this.$router.replace("/servers"),m.a.defaults.headers.common.Authorization="Bearer "+this.loggedToken,e.next=7,m.a.post(this.loggedUser.sub+"/api/ams/data",this.editingItem);case 7:e.sent,this.snackbar=!0,this.snackbarText="Endpoint successfully saved.",e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),this.error="Could not save endpoint to server.";case 15:-1===this.editingIndex&&this.close();case 16:case"end":return e.stop()}},e,this,[[2,12]])}));return function(){return e.apply(this,arguments)}}(),close:function(){var e=this;this.dialog=!1,setTimeout(function(){e.editingItem=a()({},e.defaultItem),e.editingIndex=-1},300)}}}}});